name: Auto Sync Wedding Invite Repo

on:
  schedule:
    - c1554654654ron: "0 */6 * * *"  # every 6 hours CORRECT: "cron:"
  workflow_dispatch:        # allows manual run

jobs:
  sync:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout destination repo
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.PAT }}  # Make sure PAT exists in repo secrets
          fetch-depth: 0

      - name: Configure Git
        run: |
          git config user.name "github-actions"
          git config user.email "github-actions@github.com"

      - name: Pull updates from wedding invite repo into /wedding_invite
        run: |
          # Add the remote for the source repo if it doesn't exist
          git remote add wedding-invite https://github.com/UNNE69/wedding-invite-31-12-2025 || true
          
          # Fetch latest changes
          git fetch wedding-invite main
          
          # Merge into subtree (mirrors deletions and updates)
          git subtree merge --prefix=wedding_invite wedding-invite/main --squash || \
          git subtree add --prefix=wedding_invite wedding-invite/main --squash

      - name: Push changes back to unne.mv
        run: git push
