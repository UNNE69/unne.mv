<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Time</title>
  <link rel="stylesheet" href="/assets/css/time.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto&family=Open+Sans&family=Montserrat&family=Poppins&family=Lato&family=Oswald&family=Merriweather&family=Playfair+Display&family=Raleway&family=Ubuntu&display=swap" rel="stylesheet">
</head>
<body>
  <div class="wrap">
    <div id="clock"></div>
  </div>

  <!-- Gear / Close button -->
  <button id="gearBtn" class="gear">
    <span class="icon">⚙</span>
  </button>

  <!-- Controls panel -->
  <div id="controls" class="controls hidden">
    <div class="control-row">
      <label for="fontSize">Size</label>
      <input type="number" id="fontSize" min="50" max="600" value="120">
    </div>

    <div class="control-row">
      <label for="timeFormat">Format</label>
      <div class="custom-select-wrapper">
        <div class="custom-select" id="timeFormat">24-hour</div>
        <ul class="custom-options">
          <li data-value="24">24-hour</li>
          <li data-value="12">12-hour</li>
        </ul>
      </div>
    </div>

    <div class="control-row">
      <label for="timeZone">Time Zone</label>
      <div class="custom-select-wrapper">
        <div class="custom-select" id="timeZone">Maldives (GMT+5)</div>
        <ul class="custom-options">
          <li data-value="Indian/Maldives">Maldives – Malé (MVT, GMT+5)</li>
          <li data-value="Pacific/Midway">Samoa – Midway (GMT−11)</li>
          <li data-value="Pacific/Honolulu">USA – Honolulu (HST, GMT−10)</li>
          <li data-value="America/Anchorage">USA – Anchorage (AKST, GMT−9)</li>
          <li data-value="America/Los_Angeles">USA – Los Angeles (PST, GMT−8)</li>
          <li data-value="America/Denver">USA – Denver (MST, GMT−7)</li>
          <li data-value="America/Chicago">USA – Chicago (CST, GMT−6)</li>
          <li data-value="America/New_York">USA – New York (EST, GMT−5)</li>
          <li data-value="America/Halifax">Canada – Halifax (AST, GMT−4)</li>
          <li data-value="America/Sao_Paulo">Brazil – Sao Paulo (BRT, GMT−3)</li>
          <li data-value="America/Argentina/Buenos_Aires">Argentina – Buenos Aires (ART, GMT−3)</li>
          <li data-value="America/Godthab">Greenland – Nuuk (GMT−3)</li>
          <li data-value="Atlantic/Azores">Portugal – Azores (GMT−1)</li>
          <li data-value="Europe/London">UK – London (GMT+0)</li>
          <li data-value="Europe/Berlin">Germany – Berlin (CET, GMT+1)</li>
          <li data-value="Europe/Paris">France – Paris (CET, GMT+1)</li>
          <li data-value="Europe/Madrid">Spain – Madrid (CET, GMT+1)</li>
          <li data-value="Europe/Rome">Italy – Rome (CET, GMT+1)</li>
          <li data-value="Europe/Warsaw">Poland – Warsaw (CET, GMT+1)</li>
          <li data-value="Europe/Istanbul">Turkey – Istanbul (TRT, GMT+3)</li>
          <li data-value="Europe/Moscow">Russia – Moscow (MSK, GMT+3)</li>
          <li data-value="Africa/Cairo">Egypt – Cairo (EET, GMT+2)</li>
          <li data-value="Africa/Johannesburg">South Africa – Johannesburg (SAST, GMT+2)</li>
          <li data-value="Asia/Jerusalem">Israel – Jerusalem (IST, GMT+2)</li>
          <li data-value="Asia/Dubai">UAE – Dubai (GST, GMT+4)</li>
          <li data-value="Asia/Karachi">Pakistan – Karachi (PKT, GMT+5)</li>
          <li data-value="Asia/Colombo">Sri Lanka – Colombo (IST, GMT+5:30)</li>
          <li data-value="Asia/Kolkata">India – Kolkata (IST, GMT+5:30)</li>
          <li data-value="Asia/Kathmandu">Nepal – Kathmandu (NPT, GMT+5:45)</li>
          <li data-value="Asia/Dhaka">Bangladesh – Dhaka (BST, GMT+6)</li>
          <li data-value="Asia/Yangon">Myanmar – Yangon (MMT, GMT+6:30)</li>
          <li data-value="Asia/Bangkok">Thailand – Bangkok (ICT, GMT+7)</li>
          <li data-value="Asia/Jakarta">Indonesia – Jakarta (WIB, GMT+7)</li>
          <li data-value="Asia/Krasnoyarsk">Russia – Krasnoyarsk (KRAT, GMT+7)</li>
          <li data-value="Asia/Shanghai">China – Shanghai (CST, GMT+8)</li>
          <li data-value="Asia/Singapore">Singapore – Singapore (SGT, GMT+8)</li>
          <li data-value="Asia/Taipei">Taiwan – Taipei (CST, GMT+8)</li>
          <li data-value="Asia/Ulaanbaatar">Mongolia – Ulaanbaatar (ULAT, GMT+8)</li>
          <li data-value="Asia/Seoul">South Korea – Seoul (KST, GMT+9)</li>
          <li data-value="Asia/Tokyo">Japan – Tokyo (JST, GMT+9)</li>
          <li data-value="Australia/Perth">Australia – Perth (AWST, GMT+8)</li>
          <li data-value="Australia/Adelaide">Australia – Adelaide (ACST, GMT+9:30)</li>
          <li data-value="Australia/Sydney">Australia – Sydney (AEST, GMT+10)</li>
          <li data-value="Pacific/Noumea">New Caledonia – Noumea (NCT, GMT+11)</li>
          <li data-value="Pacific/Auckland">New Zealand – Auckland (NZST, GMT+12)</li>
          <li data-value="Pacific/Fiji">Fiji – Suva (FJT, GMT+12)</li>
          <li data-value="Pacific/Tongatapu">Tonga – Nuku'alofa (TOT, GMT+13)</li>
          <li data-value="Pacific/Kiritimati">Kiribati – Kiritimati (LINT, GMT+14)</li>
        </ul>
      </div>
    </div>

    <div class="control-row">
      <label>Font</label>
      <div class="custom-select-wrapper">
        <div class="custom-select" id="fontSelect">System UI</div>
        <ul class="custom-options">
          <!-- System fonts -->
          <li data-value="system-ui">System UI</li>
          <li data-value="Arial">Arial</li>
          <li data-value="Georgia">Georgia</li>
          <li data-value="Courier New">Courier New</li>
          <li data-value="Verdana">Verdana</li>
          <li data-value="Tahoma">Tahoma</li>
          <li data-value="Monospace">Monospace</li>
          <li data-value="Times New Roman">Times New Roman</li>
          <li data-value="Comic Sans MS">Comic Sans MS</li>
          <li data-value="Trebuchet MS">Trebuchet MS</li>
          <li data-value="Impact">Impact</li>
          <li data-value="Lucida Console">Lucida Console</li>
          <li data-value="Gill Sans">Gill Sans</li>
          <li data-value="Futura">Futura</li>
          <li data-value="Franklin Gothic Medium">Franklin Gothic Medium</li>
    
          <!-- Google Fonts -->
          <li data-value="Roboto">Roboto</li>
          <li data-value="Open Sans">Open Sans</li>
          <li data-value="Montserrat">Montserrat</li>
          <li data-value="Poppins">Poppins</li>
          <li data-value="Lato">Lato</li>
          <li data-value="Oswald">Oswald</li>
          <li data-value="Merriweather">Merriweather</li>
          <li data-value="Playfair Display">Playfair Display</li>
          <li data-value="Raleway">Raleway</li>
          <li data-value="Ubuntu">Ubuntu</li>
        </ul>
      </div>
    </div>

    <div class="control-row">
      <label>Font Color</label>
      <div class="color-picker">
        <input type="color" id="fontColor" value="#ffffff">
        <span class="color-display"></span>
      </div>
    </div>

    <div class="control-row">
      <label>Background</label>
      <div class="color-picker">
        <input type="color" id="bgColor" value="#000000">
        <span class="color-display"></span>
      </div>
    </div>

    <div class="control-row">
      <button id="fullscreenBtn">Fullscreen</button>
    </div>
  </div>

  <script>
  (function () {
    // ---------- Clock ----------
    function updateClock() {
      const now = new Date();
      const format = localStorage.getItem("timeFormat") || "24";
      const tz = localStorage.getItem("timeZone") || "Indian/Maldives";
      try {
        let options = { timeZone: tz, hour: "numeric", minute: "numeric", second: "numeric" };
        options.hour12 = (format === "12");
        const str = new Intl.DateTimeFormat([], options).format(now);
        document.getElementById("clock").textContent = str;
      } catch {
        document.getElementById("clock").textContent = now.toLocaleTimeString();
      }
    }
    setInterval(updateClock, 1000);
    updateClock();

    // ---------- Elements ----------
    const clockEl = document.getElementById("clock");
    const fontSize = document.getElementById("fontSize");
    const fontColor = document.getElementById("fontColor");
    const bgColor = document.getElementById("bgColor");

    const gearBtn = document.getElementById("gearBtn");
    const controls = document.getElementById("controls");
    const wrappers = Array.from(document.querySelectorAll(".custom-select-wrapper"));

    // ---------- Load saved prefs ----------
    window.addEventListener("load", () => {
      if (localStorage.getItem("fontSize")) {
        document.documentElement.style.setProperty("--clock-size", localStorage.getItem("fontSize") + "px");
        fontSize.value = localStorage.getItem("fontSize");
      }
      if (localStorage.getItem("fontColor")) {
        document.documentElement.style.setProperty("--font-color", localStorage.getItem("fontColor"));
        fontColor.value = localStorage.getItem("fontColor");
      }
      if (localStorage.getItem("bgColor")) {
        document.documentElement.style.setProperty("--bg-color", localStorage.getItem("bgColor"));
        bgColor.value = localStorage.getItem("bgColor");
      }

      // initialize display values for custom selects from localStorage (if present)
      const storedFormat = localStorage.getItem("timeFormat");
      if (storedFormat) {
        const el = document.getElementById("timeFormat");
        if (el) el.textContent = (storedFormat === "12") ? "12-hour" : "24-hour";
        el && (el.dataset.value = storedFormat);
      }
      const storedZone = localStorage.getItem("timeZone");
      if (storedZone) {
        const el = document.getElementById("timeZone");
        if (el) {
          // find matching li text if available
          const li = Array.from(document.querySelectorAll("#timeZone + .custom-options li")).find(l => l.dataset.value === storedZone);
          if (li) el.textContent = li.textContent;
          else el.textContent = storedZone;
          el.dataset.value = storedZone;
        }
      }
      const storedFont = localStorage.getItem("fontFamily");
      if (storedFont) {
        const el = document.getElementById("fontSelect");
        if (el) { el.textContent = storedFont; el.dataset.value = storedFont; }
        document.documentElement.style.setProperty("--font-family", storedFont);
      }

      updateColorDisplay();
    });

    // ---------- Controls handlers ----------
    fontSize.addEventListener("input", e => {
      document.documentElement.style.setProperty("--clock-size", e.target.value + "px");
      localStorage.setItem("fontSize", e.target.value);
    });

    fontColor.addEventListener("input", e => {
      document.documentElement.style.setProperty("--font-color", e.target.value);
      localStorage.setItem("fontColor", e.target.value);
      updateColorDisplay();
    });

    bgColor.addEventListener("input", e => {
      document.documentElement.style.setProperty("--bg-color", e.target.value);
      localStorage.setItem("bgColor", e.target.value);
      updateColorDisplay();
    });

    // fullscreen
    document.getElementById("fullscreenBtn").addEventListener("click", () => {
      if (!document.fullscreenElement) document.documentElement.requestFullscreen();
      else document.exitFullscreen();
    });
    document.addEventListener("keydown", e => {
      if (e.key.toLowerCase() === "f") {
        if (!document.fullscreenElement) document.documentElement.requestFullscreen();
        else document.exitFullscreen();
      }
    });

    // ---------- Auto-hide panel (pause while interacting) ----------
    let hideTimeout;
    function pauseHideTimer() { clearTimeout(hideTimeout); }
    function startHideTimer() {
      pauseHideTimer();
      hideTimeout = setTimeout(() => {
        // only hide if user is not hovering/touching the controls or any open dropdown
        if (!controls.matches(":hover") && !Array.from(document.querySelectorAll(".custom-select-wrapper")).some(w => w.matches(":hover"))) {
          hideControls();
        }
      }, 5000);
    }
    function showControls() {
      controls.classList.remove("hidden");
      const ic = gearBtn.querySelector(".icon"); if (ic) ic.textContent = "✖";
      pauseHideTimer();
      startHideTimer();
    }
    function hideControls() {
      controls.classList.add("hidden");
      const ic = gearBtn.querySelector(".icon"); if (ic) ic.textContent = "⚙";
    }

    gearBtn.addEventListener("click", () => {
      if (controls.classList.contains("hidden")) showControls();
      else hideControls();
    });

    // pause/resume when interacting with controls (mouse/touch)
    controls.addEventListener("mouseenter", pauseHideTimer);
    controls.addEventListener("mouseleave", startHideTimer);
    controls.addEventListener("touchstart", pauseHideTimer, {passive: true});
    controls.addEventListener("touchend", startHideTimer);

    // ---------- Custom dropdown behavior ----------
    wrappers.forEach(wrapper => {
      const select = wrapper.querySelector(".custom-select");
      const options = wrapper.querySelector(".custom-options");

      // safety: if no select/options, skip
      if (!select || !options) return;

      // When clicking the select box
      select.addEventListener("click", e => {
        e.stopPropagation();

        // close other dropdowns
        wrappers.forEach(w => {
          const opts = w.querySelector(".custom-options");
          if (w !== wrapper) {
            w.classList.remove("active");
            opts && opts.classList.remove("open");
          }
        });

        // toggle this one
        const isActive = wrapper.classList.toggle("active");
        options.classList.toggle("open", isActive);

        // pause auto-hide while interacting
        if (isActive) pauseHideTimer();
        else startHideTimer();
      });

      // Keep panel from auto-hiding while hovering / touching the options
      options.addEventListener("mouseenter", pauseHideTimer);
      options.addEventListener("mouseleave", startHideTimer);
      options.addEventListener("touchstart", pauseHideTimer, {passive: true});
      options.addEventListener("touchend", startHideTimer);
      select.addEventListener("touchstart", pauseHideTimer, {passive: true});
      select.addEventListener("touchend", startHideTimer);
    });

    // When an option is clicked
    document.querySelectorAll(".custom-options li").forEach(li => {
      li.addEventListener("click", function (e) {
        e.stopPropagation();
        const wrapper = this.closest(".custom-select-wrapper");
        const display = wrapper.querySelector(".custom-select");
        const options = wrapper.querySelector(".custom-options");

        // set display text + data-value
        display.textContent = this.textContent;
        display.dataset.value = this.dataset.value;

        // close dropdown (both classes for compatibility)
        wrapper.classList.remove("active");
        options.classList.remove("open");

        // save selection
        if (display.id === "timeFormat") {
          localStorage.setItem("timeFormat", this.dataset.value);
        } else if (display.id === "timeZone") {
          localStorage.setItem("timeZone", this.dataset.value);
        } else if (display.id === "fontSelect") {
          document.documentElement.style.setProperty("--font-family", this.dataset.value);
          localStorage.setItem("fontFamily", this.dataset.value);
        }

        // restart hide timer (menu may auto-hide after delay)
        startHideTimer();
      });
    });

    // Close dropdowns on outside click
    document.addEventListener("click", (e) => {
      if (!e.target.closest(".custom-select-wrapper")) {
        wrappers.forEach(w => {
          w.classList.remove("active");
          const opts = w.querySelector(".custom-options");
          opts && opts.classList.remove("open");
        });
      }
    });

    // ---------- Color swatches ----------
    function updateColorDisplay() {
      document.querySelectorAll(".color-picker").forEach(picker => {
        const input = picker.querySelector("input[type=color]");
        const display = picker.querySelector(".color-display");
        if (!input || !display) return;
        display.style.background = input.value;
        display.textContent = input.value.toUpperCase();
      });
    }
    document.querySelectorAll(".color-picker input").forEach(input => {
      input.addEventListener("input", updateColorDisplay);
    });

    // init color displays once
    updateColorDisplay();

    // Start initial hide timer so gear fades away after idle
    startHideTimer();
  })();
  </script>
</body>
</html>
