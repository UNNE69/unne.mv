<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Time Display</title>
  <link rel="stylesheet" href="assets/css/time.css">
</head>
<body>
  <div class="wrap">
    <div id="clock"></div>
  </div>

  <!-- Gear / Close button -->
  <button id="gearBtn" class="gear">
    <span class="icon">⚙</span>
  </button>

  <!-- Controls panel -->
  <div id="controls" class="controls hidden">
    <div class="control-row">
      <label for="fontSize">Size</label>
      <input type="number" id="fontSize" min="50" max="600" value="120">
    </div>

    <div class="control-row">
      <label for="timeFormat">Format</label>
      <div class="custom-select-wrapper">
        <div class="custom-select" id="timeFormat">24-hour</div>
        <ul class="custom-options">
          <li data-value="24">24-hour</li>
          <li data-value="12">12-hour</li>
        </ul>
      </div>
    </div>

    <div class="control-row">
      <label for="timeZone">Time Zone</label>
      <div class="custom-select-wrapper">
        <div class="custom-select" id="timeZone">Maldives (GMT+5)</div>
        <ul class="custom-options">
          <li data-value="Indian/Maldives">Maldives (GMT+5)</li>
          <li data-value="Asia/Kolkata">India – Kolkata (GMT+5:30)</li>
          <li data-value="Asia/Dubai">UAE – Dubai (GMT+4)</li>
          <li data-value="Europe/London">London (GMT+0)</li>
          <li data-value="America/New_York">New York (GMT-5)</li>
          <li data-value="Asia/Tokyo">Tokyo (GMT+9)</li>
          <li data-value="Australia/Sydney">Sydney (GMT+10)</li>
        </ul>
      </div>
    </div>

    <div class="control-row">
      <label>Font</label>
      <div class="custom-select-wrapper">
        <div class="custom-select" id="fontSelect">System UI</div>
        <ul class="custom-options">
          <li data-value="system-ui">System UI</li>
          <li data-value="Arial">Arial</li>
          <li data-value="Georgia">Georgia</li>
          <li data-value="Courier New">Courier New</li>
          <li data-value="Verdana">Verdana</li>
          <li data-value="Tahoma">Tahoma</li>
          <li data-value="Monospace">Monospace</li>
        </ul>
      </div>
    </div>

    <div class="control-row">
      <label>Font Color</label>
      <div class="color-picker">
        <input type="color" id="fontColor" value="#ffffff">
        <span class="color-display"></span>
      </div>
    </div>

    <div class="control-row">
      <label>Background</label>
      <div class="color-picker">
        <input type="color" id="bgColor" value="#000000">
        <span class="color-display"></span>
      </div>
    </div>

    <div class="control-row">
      <button id="fullscreenBtn">Fullscreen</button>
    </div>
  </div>

  <script>
    // Clock update
    function updateClock() {
      const now = new Date();
      const format = localStorage.getItem("timeFormat") || "24";
      const tz = localStorage.getItem("timeZone") || "Indian/Maldives";
      try {
        let options = { timeZone: tz, hour: "numeric", minute: "numeric", second: "numeric" };
        if (format === "12") options.hour12 = true;
        else options.hour12 = false;
        const str = new Intl.DateTimeFormat([], options).format(now);
        document.getElementById("clock").textContent = str;
      } catch {
        document.getElementById("clock").textContent = now.toLocaleTimeString();
      }
    }
    setInterval(updateClock, 1000);
    updateClock();

    // Controls
    const clockEl = document.getElementById("clock");
    const fontSize = document.getElementById("fontSize");
    const fontColor = document.getElementById("fontColor");
    const bgColor = document.getElementById("bgColor");

    fontSize.addEventListener("input", e => {
      document.documentElement.style.setProperty("--clock-size", e.target.value + "px");
      localStorage.setItem("fontSize", e.target.value);
    });

    fontColor.addEventListener("input", e => {
      document.documentElement.style.setProperty("--font-color", e.target.value);
      localStorage.setItem("fontColor", e.target.value);
      updateColorDisplay();
    });

    bgColor.addEventListener("input", e => {
      document.documentElement.style.setProperty("--bg-color", e.target.value);
      localStorage.setItem("bgColor", e.target.value);
      updateColorDisplay();
    });

    // Fullscreen
    document.getElementById("fullscreenBtn").addEventListener("click", () => {
      if (!document.fullscreenElement) {
        document.documentElement.requestFullscreen();
      } else {
        document.exitFullscreen();
      }
    });
    document.addEventListener("keydown", e => {
      if (e.key.toLowerCase() === "f") {
        if (!document.fullscreenElement) document.documentElement.requestFullscreen();
        else document.exitFullscreen();
      }
    });

    // Load saved prefs
    window.addEventListener("load", () => {
      if (localStorage.getItem("fontSize")) {
        document.documentElement.style.setProperty("--clock-size", localStorage.getItem("fontSize") + "px");
        fontSize.value = localStorage.getItem("fontSize");
      }
      if (localStorage.getItem("fontColor")) {
        document.documentElement.style.setProperty("--font-color", localStorage.getItem("fontColor"));
        fontColor.value = localStorage.getItem("fontColor");
      }
      if (localStorage.getItem("bgColor")) {
        document.documentElement.style.setProperty("--bg-color", localStorage.getItem("bgColor"));
        bgColor.value = localStorage.getItem("bgColor");
      }
      updateColorDisplay();
    });

    // Gear button & menu behavior
    const gearBtn = document.getElementById("gearBtn");
    const controls = document.getElementById("controls");
    let hideTimeout;

    function showControls() {
      controls.classList.remove("hidden");
      gearBtn.querySelector(".icon").textContent = "✖";
      clearTimeout(hideTimeout);
      hideTimeout = setTimeout(hideControls, 5000);
    }
    function hideControls() {
      controls.classList.add("hidden");
      gearBtn.querySelector(".icon").textContent = "⚙";
    }

    gearBtn.addEventListener("click", () => {
      if (controls.classList.contains("hidden")) showControls();
      else hideControls();
    });

    // Custom selects
    document.querySelectorAll(".custom-select").forEach(select => {
      select.addEventListener("click", function () {
        const wrapper = this.parentElement;
        const options = wrapper.querySelector(".custom-options");

        // Close others
        document.querySelectorAll(".custom-options.open").forEach(opt => {
          if (opt !== options) opt.classList.remove("open");
        });

        options.classList.toggle("open");
      });
    });

    document.querySelectorAll(".custom-options li").forEach(option => {
      option.addEventListener("click", function () {
        const wrapper = this.closest(".custom-select-wrapper");
        const display = wrapper.querySelector(".custom-select");
        display.textContent = this.textContent;
        display.dataset.value = this.dataset.value;
        this.parentElement.classList.remove("open");

        if (display.id === "timeFormat") {
          localStorage.setItem("timeFormat", this.dataset.value);
        }
        if (display.id === "timeZone") {
          localStorage.setItem("timeZone", this.dataset.value);
        }
        if (display.id === "fontSelect") {
          document.documentElement.style.setProperty("--font-family", this.dataset.value);
          localStorage.setItem("fontFamily", this.dataset.value);
        }
      });
    });

    document.addEventListener("click", e => {
      if (!e.target.closest(".custom-select-wrapper")) {
        document.querySelectorAll(".custom-options.open").forEach(opt => opt.classList.remove("open"));
      }
    });

    // Color swatches
    function updateColorDisplay() {
      document.querySelectorAll(".color-picker").forEach(picker => {
        const input = picker.querySelector("input[type=color]");
        const display = picker.querySelector(".color-display");
        display.style.background = input.value;
        display.textContent = input.value.toUpperCase();
      });
    }
    document.querySelectorAll(".color-picker input").forEach(input => {
      input.addEventListener("input", updateColorDisplay);
    });
  </script>
</body>
</html>
